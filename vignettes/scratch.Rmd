---
title: "Doodle Pad"
author: "Zebulun Arendsee"
date: "`r Sys.Date()`"
output:
    rmarkdown::html_vignette:
        fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Doodle Pad}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Environment structure

```
[ empty ]
   ^
   |
[ base ]
   ^
   |
[ pied ]  <------------.
   ^                   |
   |                   |
[ ... ]             [ ... ]
   ^                   |
   |                   |
[ node_cls ] < . . . * |
   ^1                  |
   |m                  |
[ connect ]  < . . . * |
   ^1                  |
   |n                  |
[ instance ] < . * [ global ]
```

The nodes can't see the global environment. All elements of function live in
`node_cls`. They exist as parametric function classes. The `connect` function
uses a simple node language to build a instances of the workflow.

# Example

```{r}

raise <- function(space, x){
    xname <- deparse(substitute(x))
    space[[xname]] <- x 
    environment(space[[xname]]) <- space
}

space <- function(parent=baseenv()){
  space <- new.env()
  parent.env(space) <- parent 
  with(
    space,
    {
      map    <- new.env()
      chk    <- new.env()
      pass   <- new.env()
      fail   <- new.env()
      effect <- new.env()
      cache  <- new.env()
    }
  )
  space
}

```
